<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>案件管理システム</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- ログイン画面 -->
  <div id="login-view" class="subview">
    <h2>ログイン</h2>
    <div id="login-error" style="color:red;"></div>
    <label>
      メールアドレス（または admin / admin）:<br>
      <input type="email" id="email">
    </label><br>
    <label>
      パスワード:<br>
      <input type="password" id="password">
    </label><br>
    <button id="login-btn">ログイン</button>
    <button id="signup-btn">新規登録</button>
    <button id="guest-btn">ゲストログイン</button><br>
    <button id="reset-btn">パスワード再発行</button>
  </div>

  <!-- メイン画面 -->
  <div id="main-view" class="subview" style="display:none;">
    <button id="logout-btn">ログアウト</button>
    <nav>
      <button id="nav-add-btn">案件追加</button>
      <button id="nav-search-btn">案件検索</button>
    </nav>

    <!-- 案件追加ビュー -->
    <div id="add-case-view" class="subview">
      <!-- QRスキャンモード -->
      <div id="scan-mode">
        <h3>QRコード読み取り</h3>
        <input type="text" id="case-barcode" placeholder="ここにQRコードの文字列を貼り付け、Enter">
        <button id="start-manual-btn">手動入力に切替</button>
      </div>
      <!-- 手動入力モード -->
      <div id="manual-mode" style="display:none;">
        <h3>手動入力</h3>
        <label>受注番号:<br><input type="text" id="manual-order-id"></label><br>
        <label>得意先:<br><input type="text" id="manual-customer"></label><br>
        <label>品名:<br><input type="text" id="manual-title"></label><br>
        <button id="manual-confirm-btn">確定</button>
        <button id="start-scan-btn">スキャンに戻す</button>
      </div>
      <!-- 案件詳細（QR／手動後） -->
      <div id="case-details" style="display:none;">
        <h3>案件情報</h3>
        <div>受注番号: <span id="detail-order-id"></span></div>
        <div>得意先: <span id="detail-customer"></span></div>
        <div>品名: <span id="detail-title"></span></div>

        <label><input type="checkbox" id="fixed-carrier-checkbox"> 運送会社を固定する</label>
        <select id="fixed-carrier-select" style="display:none;">
          <option value="">選択してください</option>
          <option value="sagawa">佐川急便</option>
          <option value="yamato">ヤマト運輸</option>
          <option value="fukutsu">福山通運</option>
          <option value="seino">西濃運輸</option>
          <option value="tonami">トナミ運輸</option>
        </select>

        <h4>追跡番号リスト設定</h4>
        <div id="tracking-rows"></div>
        <button id="add-tracking-row-btn">＋追跡番号行を追加</button><br>
        <button id="confirm-add-case-btn">案件登録</button>
        <div id="add-case-msg" style="color:green;"></div>
        <button id="another-case-btn">別の案件追加</button>
      </div>
    </div>

    <!-- 案件検索ビュー -->
    <div id="search-view" class="subview" style="display:none;">
      <h3>案件検索</h3>
      <label>キーワード:<input type="text" id="search-input"></label>
      <button id="search-btn">検索</button>
      <button id="list-all-btn">全件一覧</button>
      <ul id="search-results"></ul>
    </div>

    <!-- 案件詳細ビュー -->
    <div id="case-detail-view" class="subview" style="display:none;">
      <h3>案件詳細</h3>
      <div id="detail-info"></div>
      <ul id="detail-shipments"></ul>
      <button id="show-add-tracking-btn">追跡番号追加</button>

      <div id="add-tracking-detail" style="display:none;">
        <h4>追跡番号追加</h4>
        <div id="detail-tracking-rows"></div>
        <button id="detail-add-tracking-row-btn">＋追跡番号行を追加</button>
        <button id="confirm-detail-add-btn">追加確定</button>
        <div id="detail-add-msg" style="color:green;"></div>
        <button id="cancel-detail-add-btn">キャンセル</button>
      </div>

      <button id="back-to-search-btn">検索に戻る</button>
      <button id="another-case-btn-2">別の案件追加</button>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <!-- pako (zlib 展開用) -->
  <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
  <!-- メインの JS（上記で変更した API_URL 版） -->
  <script src="main.js"></script>
</body>
</html>
